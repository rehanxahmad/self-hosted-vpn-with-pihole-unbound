# Unbound Recursive DNS Configuration
# For use with PiHole in self-hosted VPN setup
# File: /etc/unbound/unbound.conf.d/pi-hole.conf

server:
    # Network interface and port configuration
    interface: 127.0.0.1
    port: 5335
    do-ip4: yes
    do-udp: yes
    do-tcp: yes

    # IPv6 configuration (disabled for simplicity)
    do-ip6: no
    prefer-ip6: no

    # Root hints file location
    root-hints: "/var/lib/unbound/root.hints"

    # Performance tuning for small VPS
    num-threads: 4
    msg-cache-slabs: 8
    rrset-cache-slabs: 8
    infra-cache-slabs: 8
    key-cache-slabs: 8
    rrset-cache-size: 256m
    msg-cache-size: 128m
    so-rcvbuf: 1m

    # Privacy and security enhancements
    hide-identity: yes
    hide-version: yes
    harden-glue: yes
    harden-dnssec-stripped: yes
    harden-below-nxdomain: yes
    harden-referral-path: yes
    unwanted-reply-threshold: 10000000

    # Performance optimizations
    prefetch: yes
    prefetch-key: yes
    target-fetch-policy: "3 2 1 0 0"

    # Access control - allow local networks only
    access-control: 127.0.0.1/32 allow
    access-control: 10.0.0.0/8 allow
    access-control: 172.16.0.0/12 allow
    access-control: 192.168.0.0/16 allow

    # Optional: Custom local DNS records
    # local-zone: "example.local." static
    # local-data: "server.example.local. IN A 192.168.1.100"
